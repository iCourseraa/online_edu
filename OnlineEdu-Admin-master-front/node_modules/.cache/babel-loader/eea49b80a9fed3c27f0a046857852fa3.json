{"remainingRequest":"C:\\Users\\86193\\Desktop\\online_edu_V1224\\OnlineEdu-Admin-master-front\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\86193\\Desktop\\online_edu_V1224\\OnlineEdu-Admin-master-front\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\86193\\Desktop\\online_edu_V1224\\OnlineEdu-Admin-master-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\86193\\Desktop\\online_edu_V1224\\OnlineEdu-Admin-master-front\\src\\views\\edu_course\\educourse_tmp_watch.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\86193\\Desktop\\online_edu_V1224\\OnlineEdu-Admin-master-front\\src\\views\\edu_course\\educourse_tmp_watch.vue","mtime":1734500743031},{"path":"C:\\Users\\86193\\Desktop\\online_edu_V1224\\OnlineEdu-Admin-master-front\\babel.config.js","mtime":1734500708555},{"path":"C:\\Users\\86193\\Desktop\\online_edu_V1224\\OnlineEdu-Admin-master-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\86193\\Desktop\\online_edu_V1224\\OnlineEdu-Admin-master-front\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\86193\\Desktop\\online_edu_V1224\\OnlineEdu-Admin-master-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\86193\\Desktop\\online_edu_V1224\\OnlineEdu-Admin-master-front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIGZyb20gIkM6L1VzZXJzLzg2MTkzL0Rlc2t0b3Avb25saW5lX2VkdV9WMTIyNC9PbmxpbmVFZHUtQWRtaW4tbWFzdGVyLWZyb250L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGxpc3RDaGFwdGVyc1RtcCBhcyBsaXN0Q2hhcHRlcnMgfSBmcm9tICdAL2FwaS9jaGFwdGVyJzsKaW1wb3J0IHsgbGlzdFZpZGVvc1RtcCBhcyBsaXN0VmlkZW9zLCBnZXRQbGF5QXV0aCB9IGZyb20gJ0AvYXBpL3ZpZGVvJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdFZHVjb3Vyc2VXYXRjaCcsCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGNvdXJzZUlkOiBudWxsLAogICAgICBwbGF5ZXI6IG51bGwsCiAgICAgIGNoYXB0ZXJEYXRhOiBbXSwKICAgICAgLy8gPGNoYXB0ZXJJZCwgdmlkZW9MaXN0PgogICAgICB2aWRlb0RhdGE6IHt9LAogICAgICByZWZyZXNoS2V5OiBmYWxzZSwKICAgICAgYWN0aXZlSXRlbTogJycKICAgIH07CiAgfSwKICBtZXRob2RzOiB7CiAgICBzZXREYXRhOiBmdW5jdGlvbiBzZXREYXRhKGNvdXJzZUlkKSB7CiAgICAgIHRoaXMuY291cnNlSWQgPSBjb3Vyc2VJZDsKICAgICAgdGhpcy5saXN0Q2hhcHRlcnNBbmRWaWRlb3MoY291cnNlSWQpOwogICAgfSwKICAgIGxpc3RDaGFwdGVyc0FuZFZpZGVvczogZnVuY3Rpb24gbGlzdENoYXB0ZXJzQW5kVmlkZW9zKGNvdXJzZUlkKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIGxpc3RDaGFwdGVycyhjb3Vyc2VJZCkudGhlbihmdW5jdGlvbiAocmVzcCkgewogICAgICAgIF90aGlzLmNoYXB0ZXJEYXRhID0gcmVzcC5kYXRhOwogICAgICAgIHZhciBsZW4gPSByZXNwLmRhdGEubGVuZ3RoOwogICAgICAgIHZhciBfaXRlcmF0b3IgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihyZXNwLmRhdGEpLAogICAgICAgICAgX3N0ZXA7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIHZhciBfbG9vcCA9IGZ1bmN0aW9uIF9sb29wKCkgewogICAgICAgICAgICB2YXIgYyA9IF9zdGVwLnZhbHVlOwogICAgICAgICAgICBsaXN0VmlkZW9zKGMuaWQpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgICAgICAgICBfdGhpcy52aWRlb0RhdGFbYy5pZF0gPSByZXNwLmRhdGE7CiAgICAgICAgICAgICAgLy8g6I635Y+W5a6M6KeG6aKR5YiX6KGoCiAgICAgICAgICAgICAgaWYgKC0tbGVuIDw9IDApIHsKICAgICAgICAgICAgICAgIC8vIOWFs+mUru+8muW8uuWItuWIt+aWsOe7hOS7tua4suafkwogICAgICAgICAgICAgICAgX3RoaXMucmVmcmVzaEtleSA9ICFfdGhpcy5yZWZyZXNoS2V5OwogICAgICAgICAgICAgICAgLy8g5YeG5aSH56ys5LiA5Liq6KeG6aKRCiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICB2YXIgZmlyc3RDaGFwdGVySWQgPSBfdGhpcy5jaGFwdGVyRGF0YVswXS5pZDsKICAgICAgICAgICAgICAgICAgdmFyIGZpcnN0VmlkZW8gPSBfdGhpcy52aWRlb0RhdGFbZmlyc3RDaGFwdGVySWRdWzBdOwogICAgICAgICAgICAgICAgICBfdGhpcy5wbGF5KGZpcnN0VmlkZW8udmlkZW9JZCk7CiAgICAgICAgICAgICAgICAgIC8vIOiuvue9ruesrOS4gOS4quinhumikea/gOa0uwogICAgICAgICAgICAgICAgICBfdGhpcy5hY3RpdmVJdGVtID0gIiIuY29uY2F0KGZpcnN0Q2hhcHRlcklkLCAiOiIpLmNvbmNhdChmaXJzdFZpZGVvLmlkKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH07CiAgICAgICAgICBmb3IgKF9pdGVyYXRvci5zKCk7ICEoX3N0ZXAgPSBfaXRlcmF0b3IubigpKS5kb25lOykgewogICAgICAgICAgICBfbG9vcCgpOwogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgX2l0ZXJhdG9yLmUoZXJyKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgX2l0ZXJhdG9yLmYoKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIHBsYXk6IGZ1bmN0aW9uIHBsYXkodmlkZW9Tb3VyY2VJZCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKICAgICAgaWYgKHRoaXMucGxheWVyKSB7CiAgICAgICAgLy8gY29uc3QgYXV0b1BsYXkgPSB0aGlzLnBsYXllci5nZXRTdGF0dXMoKSA9PT0gJ3BsYXlpbmcnCiAgICAgICAgLy8g6ZSA5q+B5pKt5pS+5ZmoCiAgICAgICAgdGhpcy5wbGF5ZXIuZGlzcG9zZSgpOwogICAgICAgIHRoaXMucGxheWVyID0gbnVsbDsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnSl9wcmlzbVBsYXllcicpLmlubmVySFRNTCA9ICcnOwogICAgICAgIGdldFBsYXlBdXRoKHZpZGVvU291cmNlSWQpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bmRlZgogICAgICAgICAgX3RoaXMyLnBsYXllciA9IG5ldyBBbGlwbGF5ZXIoewogICAgICAgICAgICBpZDogJ0pfcHJpc21QbGF5ZXInLAogICAgICAgICAgICBhdXRvcGxheTogZmFsc2UsCiAgICAgICAgICAgIHdpZHRoOiAnMTAwJScsCiAgICAgICAgICAgIGhlaWdodDogJzEwMCUnLAogICAgICAgICAgICB2aWQ6IHZpZGVvU291cmNlSWQsCiAgICAgICAgICAgIHBsYXlhdXRoOiByZXNwLmRhdGEKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIGdldFBsYXlBdXRoKHZpZGVvU291cmNlSWQpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bmRlZgogICAgICAgICAgX3RoaXMyLnBsYXllciA9IG5ldyBBbGlwbGF5ZXIoewogICAgICAgICAgICBpZDogJ0pfcHJpc21QbGF5ZXInLAogICAgICAgICAgICBhdXRvcGxheTogZmFsc2UsCiAgICAgICAgICAgIHdpZHRoOiAnMTAwJScsCiAgICAgICAgICAgIGhlaWdodDogJzEwMCUnLAogICAgICAgICAgICB2aWQ6IHZpZGVvU291cmNlSWQsCiAgICAgICAgICAgIHBsYXlhdXRoOiByZXNwLmRhdGEKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgZGlzcG9zZTogZnVuY3Rpb24gZGlzcG9zZSgpIHsKICAgICAgaWYgKHRoaXMucGxheWVyKSB7CiAgICAgICAgdGhpcy5wbGF5ZXIuZGlzcG9zZSgpOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdKX3ByaXNtUGxheWVyJykuaW5uZXJIVE1MID0gJyc7CiAgICAgIH0KICAgIH0KICB9Cn07"},{"version":3,"names":["listChaptersTmp","listChapters","listVideosTmp","listVideos","getPlayAuth","name","data","courseId","player","chapterData","videoData","refreshKey","activeItem","methods","setData","listChaptersAndVideos","_this","then","resp","len","length","_iterator","_createForOfIteratorHelper","_step","_loop","c","value","id","firstChapterId","firstVideo","play","videoId","concat","e","console","log","s","n","done","err","f","videoSourceId","_this2","dispose","document","getElementById","innerHTML","Aliplayer","autoplay","width","height","vid","playauth"],"sources":["src/views/edu_course/educourse_tmp_watch.vue"],"sourcesContent":["<template>\r\n  <el-row style=\"position: relative\" class=\"course\">\r\n    <el-col :span=\"17\" style=\"position: relative\">\r\n      <div style=\"padding-top: 70%\" />\r\n      <div style=\"position: absolute;top: 0;left: 0;width: 100%;height: 100%;\">\r\n        <div id=\"J_prismPlayer\" />\r\n      </div>\r\n    </el-col>\r\n    <el-col :key=\"refreshKey\" :span=\"7\" class=\"selection\">\r\n      <div v-for=\"chapter of chapterData\" :key=\"chapter.id\" class=\"chapter\">\r\n        <div class=\"title ellipsis\" :title=\"chapter.title\">{{ chapter.title }}</div>\r\n        <div\r\n          v-for=\"(value) of videoData[chapter.id]\"\r\n          :key=\"`${chapter.id}:${value.id}`\"\r\n          :class=\"{'video':true,'active':activeItem===`${chapter.id}:${value.id}`}\"\r\n          @click=\"play(value.videoId);activeItem=`${chapter.id}:${value.id}`;\"\r\n        >\r\n          <div class=\"title ellipsis\" :title=\"value.title\">\r\n            <i v-if=\"value.oid>0\" class=\"el-icon-video-play\" />\r\n            <el-badge v-else is-dot>\r\n              <i class=\"el-icon-video-play\" />\r\n            </el-badge>\r\n            {{ value.title }}\r\n          </div>\r\n          <div class=\"info\">\r\n            <span class=\"duration\">时长: {{ value.duration }}</span>\r\n            <span v-if=\"value.free\" class=\"free\">免费</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </el-col>\r\n  </el-row>\r\n</template>\r\n\r\n<script>\r\nimport { listChaptersTmp as listChapters } from '@/api/chapter'\r\nimport { listVideosTmp as listVideos, getPlayAuth } from '@/api/video'\r\n\r\nexport default {\r\n  name: 'EducourseWatch',\r\n  data() {\r\n    return {\r\n      courseId: null,\r\n      player: null,\r\n      chapterData: [],\r\n      // <chapterId, videoList>\r\n      videoData: {},\r\n      refreshKey: false,\r\n      activeItem: ''\r\n    }\r\n  },\r\n  methods: {\r\n    setData(courseId) {\r\n      this.courseId = courseId\r\n      this.listChaptersAndVideos(courseId)\r\n    },\r\n    listChaptersAndVideos(courseId) {\r\n      listChapters(courseId).then(resp => {\r\n        this.chapterData = resp.data\r\n        let len = resp.data.length\r\n        for (const c of resp.data) {\r\n          listVideos(c.id).then(resp => {\r\n            this.videoData[c.id] = resp.data\r\n            // 获取完视频列表\r\n            if (--len <= 0) {\r\n              // 关键：强制刷新组件渲染\r\n              this.refreshKey = !this.refreshKey\r\n              // 准备第一个视频\r\n              try {\r\n                const firstChapterId = this.chapterData[0].id\r\n                const firstVideo = this.videoData[firstChapterId][0]\r\n                this.play(firstVideo.videoId)\r\n                // 设置第一个视频激活\r\n                this.activeItem = `${firstChapterId}:${firstVideo.id}`\r\n              } catch (e) {\r\n                console.log(e)\r\n              }\r\n            }\r\n          })\r\n        }\r\n      })\r\n    },\r\n    play(videoSourceId) {\r\n      if (this.player) {\r\n        // const autoPlay = this.player.getStatus() === 'playing'\r\n        // 销毁播放器\r\n        this.player.dispose()\r\n        this.player = null\r\n        document.getElementById('J_prismPlayer').innerHTML = ''\r\n        getPlayAuth(videoSourceId).then(resp => {\r\n          // eslint-disable-next-line no-undef\r\n          this.player = new Aliplayer({\r\n            id: 'J_prismPlayer',\r\n            autoplay: false,\r\n            width: '100%',\r\n            height: '100%',\r\n            vid: videoSourceId,\r\n            playauth: resp.data\r\n          })\r\n        })\r\n      } else {\r\n        getPlayAuth(videoSourceId).then(resp => {\r\n          // eslint-disable-next-line no-undef\r\n          this.player = new Aliplayer({\r\n            id: 'J_prismPlayer',\r\n            autoplay: false,\r\n            width: '100%',\r\n            height: '100%',\r\n            vid: videoSourceId,\r\n            playauth: resp.data\r\n          })\r\n        })\r\n      }\r\n    },\r\n    dispose() {\r\n      if (this.player) {\r\n        this.player.dispose()\r\n        document.getElementById('J_prismPlayer').innerHTML = ''\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n\r\n.course {\r\n  .selection {\r\n    position: absolute;\r\n    right: 0;\r\n    height: 100%;\r\n    padding: 20px 16px;\r\n    overflow: auto;\r\n    background-color: #232323;\r\n    &::-webkit-scrollbar {\r\n      width: 4px;\r\n    }\r\n    &::-webkit-scrollbar-thumb {\r\n      background: #64a5ff;\r\n    }\r\n    &::-webkit-scrollbar-track {\r\n      background: #232323;\r\n    }\r\n  }\r\n}\r\n\r\n.chapter {\r\n  color: #c7c7c7;\r\n  margin-top: 16px;\r\n\r\n  > .title {\r\n    font-size: 16px;\r\n  }\r\n\r\n  .video {\r\n    font-size: 14px;\r\n    margin-top: 16px;\r\n    cursor: pointer;\r\n\r\n    i {\r\n      margin-right: 6px;\r\n    }\r\n\r\n    &:hover,&.active {\r\n      color: #20a0ff;\r\n\r\n      .duration {\r\n        color: #20a0ff;\r\n      }\r\n    }\r\n\r\n    .info {\r\n      font-size: 12px;\r\n      margin: 5px 0 0 20px;\r\n      color: #777777;\r\n\r\n      span {\r\n        margin-right: 12px;\r\n\r\n        &:last-child {\r\n          margin-right: 0;\r\n        }\r\n      }\r\n\r\n      .free {\r\n        color: #ff4f23;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]}]}