{"remainingRequest":"E:\\WeChat Files\\wxid_i602lxrox27v12\\FileStorage\\File\\2024-12\\online_edu (2)\\online-edu-teacher-master-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\WeChat Files\\wxid_i602lxrox27v12\\FileStorage\\File\\2024-12\\online_edu (2)\\online-edu-teacher-master-front\\src\\views\\course_add\\create_subject_and_upload.vue?vue&type=script&lang=js","dependencies":[{"path":"E:\\WeChat Files\\wxid_i602lxrox27v12\\FileStorage\\File\\2024-12\\online_edu (2)\\online-edu-teacher-master-front\\src\\views\\course_add\\create_subject_and_upload.vue","mtime":1734500782764},{"path":"E:\\WeChat Files\\wxid_i602lxrox27v12\\FileStorage\\File\\2024-12\\online_edu (2)\\online-edu-teacher-master-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1734683766888},{"path":"E:\\WeChat Files\\wxid_i602lxrox27v12\\FileStorage\\File\\2024-12\\online_edu (2)\\online-edu-teacher-master-front\\node_modules\\babel-loader\\lib\\index.js","mtime":1734683771693},{"path":"E:\\WeChat Files\\wxid_i602lxrox27v12\\FileStorage\\File\\2024-12\\online_edu (2)\\online-edu-teacher-master-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1734683766888},{"path":"E:\\WeChat Files\\wxid_i602lxrox27v12\\FileStorage\\File\\2024-12\\online_edu (2)\\online-edu-teacher-master-front\\node_modules\\vue-loader\\lib\\index.js","mtime":1734683773729}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgew0KICBsaXN0IGFzIGxpc3RDaGFwdGVyLA0KICBjcmVhdGVJdCBhcyBjcmVhdGVDaGFwdGVyLA0KICB1cGRhdGVJdCBhcyB1cGRhdGVDaGFwdGVyLA0KICBkZWxldGVJdCBhcyBkZWxldGVDaGFwdGVyDQp9IGZyb20gJ0AvYXBpL2NoYXB0ZXInDQppbXBvcnQgew0KICBsaXN0IGFzIGxpc3RWaWRlbywNCiAgdXBkYXRlSXQgYXMgdXBkYXRlVmlkZW8sDQogIGRlbGV0ZUl0IGFzIGRlbGV0ZVZpZGVvDQp9IGZyb20gJ0AvYXBpL3ZpZGVvJw0KaW1wb3J0IHsgYnl0ZXNUb1NpemUgfSBmcm9tICdAL3V0aWxzJw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICdDcmVhdGVTdWJqZWN0QW5kVXBsb2FkJywNCiAgY29tcG9uZW50czogew0KICAgICd2LXVwbG9hZC12aWRlbyc6ICgpID0+IGltcG9ydCgnQC92aWV3cy9jb3Vyc2VfYWRkL3VwbG9hZCcpDQogIH0sDQogIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSB2dWUvcmVxdWlyZS1wcm9wLXR5cGVzDQogIHByb3BzOiBbJ2NvdXJzZSddLA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBjaGFwdGVyczogW10sDQogICAgICAvLyDnq6DoioJpZOS4juinhumikeWIl+ihqOaYoOWwhDxjaGFwdGVySWQsWy4uLnZpZGVvc10+DQogICAgICBjaGFwdGVySWRWaWRlb01hcDoge30sDQogICAgICBhZGRPclVwZGF0ZUNoYXB0ZXI6IHsgdGl0bGU6ICcnLCBzb3J0OiAwIH0sDQogICAgICB1cGRhdGVWaWRlb0RhdGE6IHsgdGl0bGU6ICcnLCBzb3J0OiAwLCBmcmVlOiBmYWxzZSB9LA0KICAgICAgLy8g5a+56K+d5qGGDQogICAgICBhZGRDaGFwdGVyRGlhbG9nVmlzaWJsZTogZmFsc2UsDQogICAgICB1cGRhdGVDaGFwdGVyRGlhbG9nVmlzaWJsZTogZmFsc2UsDQogICAgICBkZWxldGVDaGFwdGVyRGlhbG9nVmlzaWJsZTogZmFsc2UsDQogICAgICB0YWJsZVJlZnJlc2hJbmRleDogMCwNCiAgICAgIC8vIOS4iuS8oOinhumikQ0KICAgICAgdXBsb2FkVmlkZW9EaWFsb2dWaXNpYmxlOiBmYWxzZSwNCiAgICAgIHVwbG9hZFZpZGVvRGlhbG9nVGl0bGU6ICcnLA0KICAgICAgLy8g5pu05paw6KeG6aKRDQogICAgICB1cGRhdGVWaWRlb0RpYWxvZ1Zpc2libGU6IGZhbHNlDQogICAgfQ0KICB9LA0KICBjcmVhdGVkKCkgew0KICAgIHRoaXMuZ2V0Q2hhcHRlckxpc3QoKQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgLy8g5a2X6IqC6L2s5o2iDQogICAgYnl0ZXNUb1NpemUoYnl0ZXMpIHsNCiAgICAgIHJldHVybiBieXRlc1RvU2l6ZShieXRlcykNCiAgICB9LA0KICAgIGdldENoYXB0ZXJMaXN0KCkgew0KICAgICAgbGlzdENoYXB0ZXIodGhpcy5jb3Vyc2UuaWQpLnRoZW4ocmVzcCA9PiB7DQogICAgICAgIHRoaXMuY2hhcHRlcnMgPSBbXQ0KICAgICAgICB0aGlzLmNoYXB0ZXJzID0gcmVzcC5kYXRhDQogICAgICAgIC8vIOWIneWni+WMluinhumikeWIl+ihqOepuuaVsOaNrg0KICAgICAgICBmb3IgKGNvbnN0IGMgb2YgcmVzcC5kYXRhKSB7DQogICAgICAgICAgdGhpcy5jaGFwdGVySWRWaWRlb01hcFtjLmlkXSA9IFtdDQogICAgICAgIH0NCiAgICAgIH0pDQogICAgfSwNCiAgICBvcGVuQWRkQ2hhcHRlckRpYWxvZygpIHsNCiAgICAgIHRoaXMuYWRkT3JVcGRhdGVDaGFwdGVyID0geyB0aXRsZTogJycsIHNvcnQ6IDAgfQ0KICAgICAgdGhpcy5hZGRDaGFwdGVyRGlhbG9nVmlzaWJsZSA9IHRydWUNCiAgICB9LA0KICAgIG9wZW5VcGRhdGVDaGFwdGVyRGlhbG9nKGN1ckRhdGEpIHsNCiAgICAgIHRoaXMuYWRkT3JVcGRhdGVDaGFwdGVyID0geyAuLi5jdXJEYXRhIH0NCiAgICAgIHRoaXMudXBkYXRlQ2hhcHRlckRpYWxvZ1Zpc2libGUgPSB0cnVlDQogICAgfSwNCiAgICBvcGVuRGVsZXRlQ2hhcHRlckRpYWxvZyhjdXJEYXRhKSB7DQogICAgICB0aGlzLmFkZE9yVXBkYXRlQ2hhcHRlciA9IGN1ckRhdGENCiAgICAgIHRoaXMuZGVsZXRlQ2hhcHRlckRpYWxvZ1Zpc2libGUgPSB0cnVlDQogICAgfSwNCiAgICBvcGVuVXBsb2FkVmlkZW9EaWFsb2coY3VyRGF0YSkgew0KICAgICAgdGhpcy51cGxvYWRWaWRlb0RpYWxvZ1RpdGxlID0gYOS4iuS8oOinhumikeiHs+eroOiKglske2N1ckRhdGEudGl0bGV9XWANCiAgICAgIHRoaXMudXBsb2FkVmlkZW9EaWFsb2dWaXNpYmxlID0gdHJ1ZQ0KICAgICAgY29uc3QgZGF0YSA9IHsgY291cnNlSWQ6IHRoaXMuY291cnNlLmlkLCBjaGFwdGVySWQ6IGN1ckRhdGEuaWQgfQ0KICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsNCiAgICAgICAgdGhpcy4kcmVmcy5VcGxvYWRWaWRlby5zZXREYXRhKGRhdGEpDQogICAgICB9LmJpbmQodGhpcyksIDEwMCkNCiAgICB9LA0KICAgIG9wZW5VcGRhdGVWaWRlb0RpYWxvZ1Zpc2libGUoY3VyRGF0YSkgew0KICAgICAgdGhpcy51cGRhdGVWaWRlb0RpYWxvZ1Zpc2libGUgPSB0cnVlDQogICAgICB0aGlzLnVwZGF0ZVZpZGVvRGF0YSA9IHsgLi4uY3VyRGF0YSB9DQogICAgfSwNCiAgICAvLyDmlrDlu7rnq6DoioINCiAgICBjcmVhdGVDaGFwdGVyKCkgew0KICAgICAgdGhpcy5hZGRPclVwZGF0ZUNoYXB0ZXIuY291cnNlSWQgPSB0aGlzLmNvdXJzZS5pZA0KICAgICAgY3JlYXRlQ2hhcHRlcih0aGlzLmFkZE9yVXBkYXRlQ2hhcHRlcikudGhlbihyZXNwID0+IHsNCiAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKHJlc3AubWVzc2FnZSkNCiAgICAgICAgdGhpcy5nZXRDaGFwdGVyTGlzdCgpDQogICAgICAgIHRoaXMuYWRkQ2hhcHRlckRpYWxvZ1Zpc2libGUgPSBmYWxzZQ0KICAgICAgfSkNCiAgICB9LA0KICAgIC8vIOS/ruaUueeroOiKgg0KICAgIHVwZGF0ZUNoYXB0ZXIoKSB7DQogICAgICB0aGlzLmFkZE9yVXBkYXRlQ2hhcHRlci5jb3Vyc2VJZCA9IHRoaXMuY291cnNlLmlkDQogICAgICB1cGRhdGVDaGFwdGVyKHRoaXMuYWRkT3JVcGRhdGVDaGFwdGVyKS50aGVuKHJlc3AgPT4gew0KICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MocmVzcC5tZXNzYWdlKQ0KICAgICAgICB0aGlzLmdldENoYXB0ZXJMaXN0KCkNCiAgICAgICAgdGhpcy51cGRhdGVDaGFwdGVyRGlhbG9nVmlzaWJsZSA9IGZhbHNlDQogICAgICB9KQ0KICAgIH0sDQogICAgLy8g5Yig6Zmk56ug6IqCDQogICAgZGVsZXRlQ2hhcHRlcigpIHsNCiAgICAgIGRlbGV0ZUNoYXB0ZXIodGhpcy5hZGRPclVwZGF0ZUNoYXB0ZXIuaWQpLnRoZW4ocmVzcCA9PiB7DQogICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2VzcyhyZXNwLm1lc3NhZ2UpDQogICAgICAgIHRoaXMuZ2V0Q2hhcHRlckxpc3QoKQ0KICAgICAgICB0aGlzLmRlbGV0ZUNoYXB0ZXJEaWFsb2dWaXNpYmxlID0gZmFsc2UNCiAgICAgIH0pDQogICAgfSwNCiAgICAvLyDnq6DoioLliIfmjaINCiAgICBjaGFuZ2UoaWQpIHsNCiAgICAgIC8vIOiOt+WPlueroOiKguinhumikeS/oeaBrw0KICAgICAgaWYgKGlkKSB7DQogICAgICAgIGxpc3RWaWRlbyhpZCkudGhlbihyZXNwID0+IHsNCiAgICAgICAgICB0aGlzLmNoYXB0ZXJJZFZpZGVvTWFwW2lkXSA9IHJlc3AuZGF0YQ0KICAgICAgICAgICsrdGhpcy50YWJsZVJlZnJlc2hJbmRleA0KICAgICAgICB9KQ0KICAgICAgfQ0KICAgIH0sDQogICAgLy8g5LiK5Lyg5a+56K+d5qGG5YWz6Zet5pe25pu05paw5L+h5oGvDQogICAgdXBsb2FkRGlhbG9nQmVmb3JlQ2xvc2UoZG9uZSkgew0KICAgICAgdGhpcy5jaGFuZ2UodGhpcy4kcmVmcy5VcGxvYWRWaWRlby5kYXRhLmNoYXB0ZXJJZCkNCiAgICAgIGRvbmUoKQ0KICAgIH0sDQogICAgLy8g5Yig6Zmk6KeG6aKRDQogICAgZGVsZXRlVmlkZW8oY3VyRGF0YSkgew0KICAgICAgZGVsZXRlVmlkZW8oY3VyRGF0YS5pZCkudGhlbihyZXNwID0+IHsNCiAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKHJlc3AubWVzc2FnZSkNCiAgICAgICAgdGhpcy5jaGFuZ2UoY3VyRGF0YS5jaGFwdGVySWQpDQogICAgICB9KQ0KICAgIH0sDQogICAgLy8g5pu05paw6KeG6aKRDQogICAgdXBkYXRlVmlkZW8oKSB7DQogICAgICB1cGRhdGVWaWRlbyh0aGlzLnVwZGF0ZVZpZGVvRGF0YSkudGhlbihyZXNwID0+IHsNCiAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKHJlc3AubWVzc2FnZSkNCiAgICAgICAgdGhpcy5jaGFuZ2UodGhpcy51cGRhdGVWaWRlb0RhdGEuY2hhcHRlcklkKQ0KICAgICAgICB0aGlzLnVwZGF0ZVZpZGVvRGlhbG9nVmlzaWJsZSA9IGZhbHNlDQogICAgICB9KQ0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["create_subject_and_upload.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"create_subject_and_upload.vue","sourceRoot":"src/views/course_add","sourcesContent":["<!-- 步骤2 ： 创建章节并上传视频 -->\r\n<template>\r\n  <div>\r\n    <div style=\"margin-bottom: 20px\">\r\n      <el-button type=\"primary\" size=\"small\" @click=\"openAddChapterDialog\">新建章节</el-button>\r\n      <div style=\"float: right;height: 32px;line-height: 32px\">\r\n        <i class=\"el-icon-loading\" />\r\n        正在创建课程《{{ course.title }}》\r\n      </div>\r\n    </div>\r\n    <el-collapse :accordion=\"true\" @change=\"change\">\r\n      <el-collapse-item v-for=\"c of chapters\" :key=\"c.id\" :name=\"c.id\" class=\"chapter-head\">\r\n        <template slot=\"title\">\r\n          <div class=\"sort\">{{ c.sort }}</div>\r\n          <div class=\"title\">{{ c.title }}</div>\r\n          <div class=\"ctrl\">\r\n            <el-button size=\"mini\" type=\"primary\" icon=\"el-icon-upload\" @click.stop=\"openUploadVideoDialog(c)\">视频\r\n            </el-button>\r\n            <el-button size=\"mini\" type=\"success\" @click.stop=\"openUpdateChapterDialog(c)\">修改</el-button>\r\n            <el-button size=\"mini\" type=\"danger\" @click.stop=\"openDeleteChapterDialog(c)\">删除</el-button>\r\n          </div>\r\n        </template>\r\n        <el-table\r\n          :key=\"tableRefreshIndex\"\r\n          :data=\"chapterIdVideoMap[c.id]\"\r\n          tooltip-effect=\"dark\"\r\n          :header-cell-style=\"{fontWeight:'normal', color:'#666'}\"\r\n          style=\"font-size: 13px\"\r\n        >\r\n          <el-table-column type=\"index\" />\r\n          <el-table-column prop=\"title\" label=\"名称\" show-tooltip-when-overflow />\r\n          <el-table-column prop=\"duration\" label=\"时长\" width=\"100\" />\r\n          <el-table-column prop=\"size\" label=\"大小\" width=\"120\">\r\n            <template slot-scope=\"scope\">{{ bytesToSize(scope.row.size) }}</template>\r\n          </el-table-column>\r\n          <el-table-column prop=\"sort\" label=\"排序\" width=\"80\" align=\"center\" />\r\n          <el-table-column prop=\"sort\" label=\"免费收看\" width=\"100\" align=\"center\">\r\n            <template slot-scope=\"scope\">\r\n              <span v-if=\"scope.row.free\" style=\"color: #21BA45\">是</span>\r\n              <span v-else>否</span>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column label=\"操作\" width=\"150\" align=\"center\">\r\n            <template slot-scope=\"scope\">\r\n              <el-button type=\"primary\" size=\"mini\" @click=\"openUpdateVideoDialogVisible(scope.row)\">修改</el-button>\r\n              <el-popconfirm\r\n                style=\"margin-left: 10px\"\r\n                placement=\"top-end\"\r\n                confirm-button-text=\"确定\"\r\n                cancel-button-text=\"取消\"\r\n                icon=\"el-icon-info\"\r\n                icon-color=\"red\"\r\n                :title=\"`你要永久删除视频[${scope.row.title}]吗？`\"\r\n                @confirm=\"deleteVideo(scope.row)\"\r\n              >\r\n                <el-button slot=\"reference\" type=\"danger\" size=\"mini\">删除</el-button>\r\n              </el-popconfirm>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n      </el-collapse-item>\r\n    </el-collapse>\r\n    <!-- 新建章节 -->\r\n    <el-dialog\r\n      title=\"新建章节\"\r\n      :visible.sync=\"addChapterDialogVisible\"\r\n      destroy-on-close\r\n      width=\"30vw\"\r\n      :close-on-click-modal=\"false\"\r\n    >\r\n      <el-form :model=\"addOrUpdateChapter\" size=\"small\" label-width=\"100px\">\r\n        <el-form-item label=\"章节名称：\">\r\n          <el-input v-model=\"addOrUpdateChapter.title\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"排　　序：\">\r\n          <el-input-number v-model=\"addOrUpdateChapter.sort\" style=\"width: 100%\" />\r\n        </el-form-item>\r\n      </el-form>\r\n      <span slot=\"footer\">\r\n        <el-button type=\"primary\" size=\"small\" @click=\"createChapter\">确 认</el-button>\r\n        <el-button size=\"small\" @click=\"addChapterDialogVisible = false\">取 消</el-button>\r\n      </span>\r\n    </el-dialog>\r\n    <!-- 修改章节信息 -->\r\n    <el-dialog\r\n      title=\"修改章节信息\"\r\n      :visible.sync=\"updateChapterDialogVisible\"\r\n      destroy-on-close\r\n      width=\"30vw\"\r\n      :close-on-click-modal=\"false\"\r\n    >\r\n      <el-form :model=\"addOrUpdateChapter\" size=\"small\" label-width=\"100px\">\r\n        <el-form-item label=\"章节名称：\">\r\n          <el-input v-model=\"addOrUpdateChapter.title\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"排序：\">\r\n          <el-input-number v-model=\"addOrUpdateChapter.sort\" style=\"width: 100%\" />\r\n        </el-form-item>\r\n      </el-form>\r\n      <span slot=\"footer\">\r\n        <el-button type=\"primary\" size=\"small\" @click=\"updateChapter\">确 认</el-button>\r\n        <el-button size=\"small\" @click=\"updateChapterDialogVisible=false\">取 消</el-button>\r\n      </span>\r\n    </el-dialog>\r\n    <!-- 删除章节 -->\r\n    <el-dialog\r\n      title=\"删除章节\"\r\n      :visible.sync=\"deleteChapterDialogVisible\"\r\n      destroy-on-close\r\n      width=\"30vw\"\r\n    >\r\n      <div style=\"color: red\">该操作将会连带删除章节下的所有视频</div>\r\n      <span slot=\"footer\">\r\n        <el-button type=\"primary\" size=\"small\" @click=\"deleteChapter\">确 认</el-button>\r\n        <el-button size=\"small\" @click=\"deleteChapterDialogVisible=false\">取 消</el-button>\r\n      </span>\r\n    </el-dialog>\r\n    <!-- 上传视频 -->\r\n    <el-dialog\r\n      :title.sync=\"uploadVideoDialogTitle\"\r\n      :visible.sync=\"uploadVideoDialogVisible\"\r\n      destroy-on-close\r\n      width=\"30vw\"\r\n      :close-on-click-modal=\"false\"\r\n      :before-close=\"uploadDialogBeforeClose\"\r\n    >\r\n      <v-upload-video ref=\"UploadVideo\" />\r\n    </el-dialog>\r\n    <!-- 修改视频信息 -->\r\n    <el-dialog\r\n      title=\"修改视频信息\"\r\n      :visible.sync=\"updateVideoDialogVisible\"\r\n      destroy-on-close\r\n      width=\"30vw\"\r\n      :close-on-click-modal=\"false\"\r\n    >\r\n      <el-form :model=\"updateVideoData\" size=\"small\" label-width=\"100px\">\r\n        <el-form-item label=\"视频名称：\">\r\n          <el-input v-model=\"updateVideoData.title\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"排　　序：\">\r\n          <el-input-number v-model=\"updateVideoData.sort\" style=\"width: 100%\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"免费观看：\">\r\n          <el-radio-group v-model=\"updateVideoData.free\">\r\n            <el-radio :label=\"true\">是</el-radio>\r\n            <el-radio :label=\"false\">否</el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n      </el-form>\r\n      <span slot=\"footer\">\r\n        <el-button type=\"primary\" size=\"small\" @click=\"updateVideo\">确 认</el-button>\r\n        <el-button size=\"small\" @click=\"updateVideoDialogVisible=false\">取 消</el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  list as listChapter,\r\n  createIt as createChapter,\r\n  updateIt as updateChapter,\r\n  deleteIt as deleteChapter\r\n} from '@/api/chapter'\r\nimport {\r\n  list as listVideo,\r\n  updateIt as updateVideo,\r\n  deleteIt as deleteVideo\r\n} from '@/api/video'\r\nimport { bytesToSize } from '@/utils'\r\n\r\nexport default {\r\n  name: 'CreateSubjectAndUpload',\r\n  components: {\r\n    'v-upload-video': () => import('@/views/course_add/upload')\r\n  },\r\n  // eslint-disable-next-line vue/require-prop-types\r\n  props: ['course'],\r\n  data() {\r\n    return {\r\n      chapters: [],\r\n      // 章节id与视频列表映射<chapterId,[...videos]>\r\n      chapterIdVideoMap: {},\r\n      addOrUpdateChapter: { title: '', sort: 0 },\r\n      updateVideoData: { title: '', sort: 0, free: false },\r\n      // 对话框\r\n      addChapterDialogVisible: false,\r\n      updateChapterDialogVisible: false,\r\n      deleteChapterDialogVisible: false,\r\n      tableRefreshIndex: 0,\r\n      // 上传视频\r\n      uploadVideoDialogVisible: false,\r\n      uploadVideoDialogTitle: '',\r\n      // 更新视频\r\n      updateVideoDialogVisible: false\r\n    }\r\n  },\r\n  created() {\r\n    this.getChapterList()\r\n  },\r\n  methods: {\r\n    // 字节转换\r\n    bytesToSize(bytes) {\r\n      return bytesToSize(bytes)\r\n    },\r\n    getChapterList() {\r\n      listChapter(this.course.id).then(resp => {\r\n        this.chapters = []\r\n        this.chapters = resp.data\r\n        // 初始化视频列表空数据\r\n        for (const c of resp.data) {\r\n          this.chapterIdVideoMap[c.id] = []\r\n        }\r\n      })\r\n    },\r\n    openAddChapterDialog() {\r\n      this.addOrUpdateChapter = { title: '', sort: 0 }\r\n      this.addChapterDialogVisible = true\r\n    },\r\n    openUpdateChapterDialog(curData) {\r\n      this.addOrUpdateChapter = { ...curData }\r\n      this.updateChapterDialogVisible = true\r\n    },\r\n    openDeleteChapterDialog(curData) {\r\n      this.addOrUpdateChapter = curData\r\n      this.deleteChapterDialogVisible = true\r\n    },\r\n    openUploadVideoDialog(curData) {\r\n      this.uploadVideoDialogTitle = `上传视频至章节[${curData.title}]`\r\n      this.uploadVideoDialogVisible = true\r\n      const data = { courseId: this.course.id, chapterId: curData.id }\r\n      setTimeout(function() {\r\n        this.$refs.UploadVideo.setData(data)\r\n      }.bind(this), 100)\r\n    },\r\n    openUpdateVideoDialogVisible(curData) {\r\n      this.updateVideoDialogVisible = true\r\n      this.updateVideoData = { ...curData }\r\n    },\r\n    // 新建章节\r\n    createChapter() {\r\n      this.addOrUpdateChapter.courseId = this.course.id\r\n      createChapter(this.addOrUpdateChapter).then(resp => {\r\n        this.$message.success(resp.message)\r\n        this.getChapterList()\r\n        this.addChapterDialogVisible = false\r\n      })\r\n    },\r\n    // 修改章节\r\n    updateChapter() {\r\n      this.addOrUpdateChapter.courseId = this.course.id\r\n      updateChapter(this.addOrUpdateChapter).then(resp => {\r\n        this.$message.success(resp.message)\r\n        this.getChapterList()\r\n        this.updateChapterDialogVisible = false\r\n      })\r\n    },\r\n    // 删除章节\r\n    deleteChapter() {\r\n      deleteChapter(this.addOrUpdateChapter.id).then(resp => {\r\n        this.$message.success(resp.message)\r\n        this.getChapterList()\r\n        this.deleteChapterDialogVisible = false\r\n      })\r\n    },\r\n    // 章节切换\r\n    change(id) {\r\n      // 获取章节视频信息\r\n      if (id) {\r\n        listVideo(id).then(resp => {\r\n          this.chapterIdVideoMap[id] = resp.data\r\n          ++this.tableRefreshIndex\r\n        })\r\n      }\r\n    },\r\n    // 上传对话框关闭时更新信息\r\n    uploadDialogBeforeClose(done) {\r\n      this.change(this.$refs.UploadVideo.data.chapterId)\r\n      done()\r\n    },\r\n    // 删除视频\r\n    deleteVideo(curData) {\r\n      deleteVideo(curData.id).then(resp => {\r\n        this.$message.success(resp.message)\r\n        this.change(curData.chapterId)\r\n      })\r\n    },\r\n    // 更新视频\r\n    updateVideo() {\r\n      updateVideo(this.updateVideoData).then(resp => {\r\n        this.$message.success(resp.message)\r\n        this.change(this.updateVideoData.chapterId)\r\n        this.updateVideoDialogVisible = false\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.chapter-head {\r\n\r\n  .sort{\r\n    width: 7%;\r\n    font-size: 15px;\r\n  }\r\n\r\n  .title {\r\n    width: 50%;\r\n    font-size: 15px;\r\n  }\r\n\r\n  .ctrl {\r\n    width: 43%;\r\n    text-align: right;\r\n\r\n    .el-button:last-child {\r\n      margin-right: 12px;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}